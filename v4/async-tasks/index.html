<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Swoole support for Mezzio"> 

    
    
        
    
    <meta name="docsearch:version" content="4.0.0,latest">
    <meta name="docsearch:language" content="en">
    <meta name="docsearch:component" content="mezzio-swoole">

    <link rel="canonical" href="https://docs.mezzio.dev/mezzio-swoole/v4/async-tasks/">
    <link rel="shortcut icon" href="https://docs.laminas.dev/img/trademark-laminas-foundation-rgb.svg">

    <title>Async Tasks - mezzio-swoole - Laminas Docs</title>

    <link rel="stylesheet" href="https://docs.laminas.dev/css/styles.css">
    
</head>
<body id="page-top" class="mezzio" data-spy="scroll" data-target=".toc" data-offset="20">

    
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        
        <a class="logo-link navbar-brand" href="https://getlaminas.org/" data-tooltip data-placement="bottom" title="Go to the Laminas homepage">
            <img src="https://docs.laminas.dev/img/laminas-foundation-white.svg" height="28" alt="Laminas">
        </a>
        <a class="navbar-title" href="https://docs.laminas.dev/" data-tooltip data-placement="bottom" title="Go to the Laminas Documentation">
            Documentation
        </a>

        
        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div class="dropdown sub-project-selector">
                        <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false">
                            All Docs
                        </a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a href="https://docs.mezzio.dev/" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-mezzio-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>Mezzio</strong><br>
                                        PSR-15 Middleware in Minutes
                                    </div>
                                </div>
                            </a>
                            <a href="https://docs.laminas.dev/components/" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-components-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>Components</strong><br>
                                        Components for Enterprise Applications
                                    </div>
                                </div>
                            </a>
                            <a href="https://docs.laminas.dev/mvc" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-mvc-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>MVC</strong><br>
                                        MVC for Enterprise Applications
                                    </div>
                                </div>
                            </a>
                            <a href="https://api-tools.getlaminas.org/documentation" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-api-tools-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>API Tools</strong><br>
                                        Build RESTful APIs in Minutes
                                    </div>
                                </div>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item dropdown-item--secondardy" href="https://docs.laminas.dev/migration/">
                                <div class="row align-items-center">
                                    <div class="col-md-8 offset-md-4 col-sm-12">
                                        Migration to Laminas
                                    </div>
                                </div>
                            </a>
                            <a class="dropdown-item dropdown-item--secondardy" href="https://docs.laminas.dev/tutorials/">
                                <div class="row align-items-center">
                                    <div class="col-md-8 offset-md-4 col-sm-12">
                                        Tutorials
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="https://getlaminas.org/participate" class="nav-link">Community</a>
                </li>
            </ul>

            
            
                <div class="d-block d-sm-none">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">mezzio-swoole</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                
                    
                        
    <li class="subnavigation__list-item ">
        <a href="../intro/" class="subnavigation__link">Introduction</a>
    </li>

                    
                        
    <li class="subnavigation__list-item">
        <span class="subnavigation__headline">Reference</span>
        <ul class="subnavigation__list">
            
                
    <li class="subnavigation__list-item ">
        <a href="../events/" class="subnavigation__link">Swoole HTTP Server Events</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../static-resources/" class="subnavigation__link">Static Resources</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../logging/" class="subnavigation__link">Logging</a>
    </li>

            
                
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Async Tasks</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../table/" class="subnavigation__link">Using Swoole Tables</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../hot-code-reload/" class="subnavigation__link">Hot Code Reloading</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../command-line/" class="subnavigation__link">Command Line Tooling</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../how-it-works/" class="subnavigation__link">How it works</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../considerations/" class="subnavigation__link">Considerations when using Swoole</a>
    </li>

            
        </ul>
    </li>

                    
                        
    <li class="subnavigation__list-item">
        <span class="subnavigation__headline">Cookbook</span>
        <ul class="subnavigation__list">
            
                
    <li class="subnavigation__list-item ">
        <a href="../cookbook/static-resource-listener-removal/" class="subnavigation__link">Removing the StaticResourceRequestListener</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../cookbook/swoole-not-starting/" class="subnavigation__link">Swoole-based server always returns home page</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../cookbook/provide-a-request-id/" class="subnavigation__link">Provide a unique ID in your request</a>
    </li>

            
        </ul>
    </li>

                    
                        
    <li class="subnavigation__list-item ">
        <a href="../migration/" class="subnavigation__link">Migration</a>
    </li>

                    
                
            

                
                

                    
                    
                
            

                
                

                    
                    
                
            

                
                

                    
                    
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="d-block d-sm-none">
                <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</nav>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-8">
                <h1 class="header__title">
                    Mezzio

                    
                        <small class="header__subtitle">mezzio-swoole</small>
                    
                </h1>
            </div>

            
            <div class="col-4 text-right">
                
                    
<div class="version-selector">
    <div class="btn-group">
        <button type="button" class="btn dropdown-toggle" data-toggle="dropdown" data-display="static" aria-haspopup="true" aria-expanded="false" id="version-selector-dropdown">
            
                v4
            
        </button>
        <div class="dropdown-menu dropdown-menu-right dropdown-menu-lg-left" aria-labelledby="version-selector-dropdown">
            
                
                    <a href="../intro/" class="dropdown-item active">
                        
                            v4 (latest)
                        
                    </a>
                
            
                
                    <a href="../../v3/intro/" class="dropdown-item">
                        
                            v3
                        
                    </a>
                
            
                
                    <a href="../../v2/intro/" class="dropdown-item">
                        
                            v2
                        
                    </a>
                
            
                
                    <a href="../../v1/intro/" class="dropdown-item">
                        
                            v1
                        
                    </a>
                
            
        </div>
    </div>
</div>


                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/mezzio/mezzio-swoole" class="header__link header__link--github" title="Go to repository of mezzio-swoole">
                        <i class="fab fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12 content" role="main">
                
                
                    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">On this page</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#configuring-the-server-process-for-tasks" class="toc__link nav-link">Configuring the Server Process for Tasks</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#task-events" class="toc__link nav-link">Task Events</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#registering-task-listeners" class="toc__link nav-link">Registering Task Listeners</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#shipped-task-listeners" class="toc__link nav-link">Shipped task listeners</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#examples" class="toc__link nav-link">Examples</a>
                    </li>
                
            </ul>
        </div>
    

                

                
                    <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/">Overview</a></li>
            <li class="breadcrumb-item"><a href="https://docs.mezzio.dev/">Mezzio</a></li>

            
                <li class="breadcrumb-item"><a href="../..">mezzio-swoole</a></li>

                
                    
                        
                        
                    
                
                    
                        
                        
                            <li class="breadcrumb-item">Reference</li>
                        
                    
                

                <li class="breadcrumb-item active" aria-current="page">Async Tasks</li>
            
        
    </ol>
</nav>






    
    
        <h2 class="chapter__headline">Reference</h2>
    

    <h1 id="triggering-async-tasks">Triggering Async Tasks</h1>
<p>Application resources requiring lengthy processing are not uncommon.
In order to prevent these processes from impacting user experience, particularly when the user does not need to wait for the process to complete, we often delegate these to a <a href="https://en.wikipedia.org/wiki/Message_queue">message queue</a>.</p>
<p>While message queues are powerful, they also require additional infrastructure for your application, and can be hard to justify when you have a small number of heavy processes, or a small number of users.</p>
<p>In order to facilitate async processing, Swoole servers provides task worker processes, allowing your application to trigger tasks without the need for an external message queue, and without impacting the server worker processes &mdash; allowing your application to continue responding to requests while the server processes your task.</p>
<h2 id="configuring-the-server-process-for-tasks">Configuring the Server Process for Tasks</h2>
<p>In order to take advantage of this feature, you will first need to configure the server to start up task workers.
In your local configuration for the server, you'll need to add <code>task_worker_num</code>.
The number of workers you configure define the number of concurrent tasks that can be executed at once.
Tasks are queued in the order that they trigger, meaning that a <code>task_worker_num</code> of 1 will offer no concurrency and tasks will execute in the order they are queued.</p>
<pre class="highlight"><code class="language-php">'mezzio-swoole' =&gt; [
    'enable_coroutine' =&gt; true, //optional to enable coroutines and useful for tasks coroutines
    'swoole-http-server' =&gt; [
        'host' =&gt; '127.0.0.1',
        'port' =&gt; 8080,
        'options' =&gt; [
            'worker_num'      =&gt; 4,          // The number of HTTP Server Workers
            'task_worker_num' =&gt; 4,          // The number of Task Workers
            'task_enable_coroutine' =&gt; true, // optional to turn on task coroutine support
        ],
    ],
];</code></pre>
<blockquote>
<h3 id="cli-options-for-worker_num-and-task_worker_num">CLI options for worker_num and task_worker_num</h3>
<p>Each of the <code>worker_num</code> and <code>task_worker_num</code> options have corresponding options in the <code>mezzio:swoole:start</code> and <code>mezzio:swoole:reload</code> console commands:</p>
<ul>
<li><code>--num-workers|-w</code> can be used to specify the number of HTTP Server Workers</li>
<li><code>--num-task-workers|-t</code> can be used to specify the number of Task Workers</li>
</ul>
</blockquote>
<h2 id="task-events">Task Events</h2>
<p><code>Mezzio\Swoole\SwooleRequestHandlerRunner</code> registers listeners on the <code>Swoole\Http\Server</code> "task" and "finish" events.  "task" is triggered when <code>$server-&gt;task()</code> is called, and "finish" is triggered when a task worker calls <code>$trigger-&gt;finish()</code>.
Each of the listeners that the <code>SwooleRequestHandlerRunner</code> class registers in turn dispatch an <a href="../events/">event via its composed PSR-14 event dispatcher</a>:</p>
<ul>
<li><code>Mezzio\Swoole\Event\TaskEvent</code> is dispatched via the "task" listener.</li>
<li><code>Mezzio\Swoole\Event\TaskFinishEvent</code> is dispatched via the "finish" listener.</li>
</ul>
<h2 id="registering-task-listeners">Registering Task Listeners</h2>
<p>Registering listeners is the same as for other events: you will specify one or more of the above event types, pointing to a list of listeners that are defined as services in your container:</p>
<pre class="highlight"><code class="language-php">// in config/autoload/mezzio.global.php:

use Mezzio\Swoole\Event;

return [
    // ...
    'mezzio-swoole' =&gt; [
        // ...
        'swoole-http-server' =&gt; [
            // ...
            'listeners' =&gt; [
                Event\TaskEvent::class =&gt; [
                    Your\TaskLoggerListener::class,
                    Your\TaskEventListener::class,
                ],
            ],
        ],
    ],
];</code></pre>
<blockquote>
<h3 id="taskfinishevent-listener-not-required">TaskFinishEvent listener not required</h3>
<p>The "finish" event primarily exists to allow you to know when a given task has completed processing.
In most cases, you can have a single listener that logs completion of the given task ID, ignoring the return value.</p>
</blockquote>
<h2 id="shipped-task-listeners">Shipped task listeners</h2>
<p>This package ships two listeners that you can use to process tasks: <code>Mezzio\Swoole\Task\TaskEventDispatchListener</code> and <code>Mezzio\Task\TaskInvokerListener</code>.</p>
<h3 id="taskeventdispatchlistener">TaskEventDispatchListener</h3>
<p><code>Mezzio\Swoole\Task\TaskEventDispatchListener</code> composes a <a href="https://www.php-fig.org/psr/psr-14/">PSR-14 event dispatcher</a> and a <a href="https://www.php-fig.org/psr/psr-3/">PSR-3 logger</a> instance.
When invoked, it retrieves the data from the <code>TaskEvent</code> (via <code>TaskEvent::getData()</code>).
If that data is not an object, it does nothing.
Otherwise, it treats it as an event, passing it to the composed event dispatcher, and setting the <code>TaskEvent</code>'s return value to the event returned by the dispatcher.
Once complete, it marks task processing as complete on the event.</p>
<p>To register this listener, use the following configuration:</p>
<pre class="highlight"><code class="language-php">// in config/autoload/mezzio.global.php:

use Mezzio\Swoole\Event;
use Mezzio\Swoole\Task\TaskEventDispatchListener;

return [
    // ...
    'mezzio-swoole' =&gt; [
        // ...
        'swoole-http-server' =&gt; [
            // ...
            'listeners' =&gt; [
                Event\TaskEvent::class =&gt; [
                    TaskEventDispatchListener::class,
                ],
            ],
        ],
    ],
];</code></pre>
<h3 id="taskinvokerlistener">TaskInvokerListener</h3>
<p><code>Mezzio\Swoole\Task\TaskInvokerListener</code> works with a suite of other classes to allow processing task data.
It composes a <a href="https://www.php-fig.org/psr/psr-11/">PSR-11 container</a> and a <a href="https://www.php-fig.org/psr/psr-3/">PSR-3 logger</a> instance.
When invoked, it pulls the data from the <code>TaskEvent</code> (via <code>TaskEvent::getData()</code>); if the data does not implement <code>Mezzio\Swoole\Task\TaskInterface</code>, it does nothing and returns immediately.
Otherwise, it invokes the task instance, passing it the PSR-11 container as the sole argument.
When done, it marks task processing complete in the <code>TaskEvent</code>.</p>
<p>The <code>TaskInterface</code> has the following definition:</p>
<pre class="highlight"><code class="language-php">namespace Mezzio\Swoole\Task;

use JsonSerializable;
use Psr\Container\ContainerInterface;

interface TaskInterface extends JsonSerializable
{
    /**
     * @return mixed
     */
    public function __invoke(ContainerInterface $container);
}</code></pre>
<p>The idea is that you can initialize a task as follows:</p>
<pre class="highlight"><code class="language-php">$server-&gt;task(new Task(
    function ($data) {
        // process the data
    },
    $data
));</code></pre>
<p>And then the <code>TaskInvokerListener</code> will intercept it, identify a task instance, and invoke it in order to process it.</p>
<p>To make this work, the package ships two <code>TaskInterface</code> implementations.
The first is <code>Mezzio\Swoole\Task\Task</code>, which composes the code that will process the task data, and the task data itself (as the "payload"):</p>
<pre class="highlight"><code class="language-php">namespace Mezzio\Swoole\Task;

use Psr\Container\ContainerInterface;

final class Task implements TaskInterface
{
    /** @var callable */
    private $handler;

    private array $payload;

    public function __construct(callable $handler, ...$payload)
    {
        $this-&gt;handler = $handler;
        $this-&gt;payload = $payload;
    }

    /**
     * Container argument ignored in this implementation.
     */
    public function __invoke(ContainerInterface $container)
    {
        return ($this-&gt;handler)(...$this-&gt;payload);
    }

    // serialization details intentionally left out of listing
}</code></pre>
<p>This works exactly like the prior example: instantiate the <code>Task</code> with the handler and any data it should process.
However, this task implementation has one caveat: the <code>$handler</code> MUST be serializable, and NOT contain references to other objects or resources (such as a database connection).
The reason is because the <code>Task</code> instance is serialized and sent to another process completely, where it is then deserialized.</p>
<p>To solve this limitation, the second implementation, <code>Mezzio\Swoole\Task\ServiceBasedTask</code>, composes a <em>service name</em> and the task data to process.
During invocation, it pulls the service from the supplied container instance, and then uses the service to process the task:</p>
<pre class="highlight"><code class="language-php">namespace Mezzio\Swoole\Task;

use Psr\Container\ContainerInterface;

final class ServiceBasedTask implements TaskInterface
{
    private array $payload;

    private string $serviceName;

    public function __construct(string $serviceName, ...$payload)
    {
        $this-&gt;serviceName = $serviceName;
        $this-&gt;payload     = $payload;
    }

    public function __invoke(ContainerInterface $container) : void
    {
        $deferred = $container-&gt;get($this-&gt;serviceName);
        $listener = $deferred instanceof DeferredServiceListener
            ? $deferred-&gt;getListener()
            : $deferred;
        $listener(...$this-&gt;payload);
    }

    // serialization details intentionally left out of listing
}</code></pre>
<p>What is the <code>DeferredServiceListener</code>? It's a decorator for an invokable handler, generally a PSR-14 event listener.
The idea behind the class is to allow dispatching events normally via a PSR-14 event dispatcher in your code, but having the listener queue a task that it then processes itself.</p>
<p>To better understand the idea, let's look at the <code>DeferredServiceListener</code>:</p>
<pre class="highlight"><code class="language-php">namespace Mezzio\Swoole\Task;

use Swoole\Http\Server as SwooleHttpServer;

final class DeferredServiceListener
{
    private SwooleHttpServer $server;

    /** @var callable */
    private $listener;

    private string $serviceName;

    public function __construct(SwooleHttpServer $server, callable $listener, string $serviceName)
    {
        $this-&gt;server      = $server;
        $this-&gt;listener    = $listener;
        $this-&gt;serviceName = $serviceName;
    }

    public function __invoke(object $event) : void
    {
        $this-&gt;server-&gt;task(new ServiceBasedTask($this-&gt;serviceName, $event));
    }

    public function getListener(): callable
    {
        return $this-&gt;listener;
    }
}</code></pre>
<p>In your configuration, you will use the <code>Mezzio\Swoole\Task\DeferredServiceListenerDelegator</code> to decorate your event listener using the above class:</p>
<pre class="highlight"><code class="language-php">// In config/autoload/dependencies.global.php:

use Mezzio\Swoole\Task\DeferredServiceListenerDelegator;

return [
    'dependences' =&gt; [
        'factories' =&gt; [
            App\Listener\UserCreationListener::class =&gt; App\Listener\UserCreationListenerFactory::class,
        ],
        'delegators' =&gt; [
            App\Listener\UserCreationListener::class =&gt; [
                DeferredServiceListenerDelegator::class,
            ],
        ],
    ],
];</code></pre>
<p>You would attach your listener as needed for your listener provider implementation, pulling the listener from the container:</p>
<pre class="highlight"><code class="language-php">use App\Event\UserCreationEvent;
use App\Listener\UserCreationListener;

// Example where $listenerProvider is a Psr\EventDispatcher\ListenerProviderInterface
// implementation, and defines a `listen()` method, and $container is a PSR-11
// container implementation:
$listenerProvider = $factory();
$listenerProvider-&gt;listen(UserCreationEvent::class, $container-&gt;get(UserCreationListener::class));</code></pre>
<p>Somewhere in your code, you might then dispatch the <code>UserCreationEvent</code>:</p>
<pre class="highlight"><code class="language-php">use App\Event\UserCreationEvent;

$dispatcher-&gt;dispatch(new UserCreationEvent($someData));</code></pre>
<p>At this point, since the listener is decorated in a <code>DeferredServiceListener</code> instance, it queues a <code>ServiceBasedTask</code>.
When the task worker goes to invoke the <code>ServiceBasedTask</code>, it pulls the service from the container... which ends up decorating it as a <code>DeferredServiceListener</code> again.
To prevent infinite recursion, where the listener keeps queueing tasks for itself, the <code>ServiceBasedTask</code> checks to see if we have a <code>DeferredServiceListener</code>, and, if so, retrieves the actual listener it decorates from it.</p>
<p>While this approach may seem convoluted, what it enables is the use of other services from your DI container when processing the task, including databases, caching, logging, and more. On top of that, it allows you to remove any references in your code to the Swoole HTTP server instance, isolating your code from the details of how the code actually executes behind a PSR-14 event dispatcher.</p>
<p><strong>This is the recommended way to queue and process tasks with mezzio-swoole.</strong></p>
<h2 id="examples">Examples</h2>
<h3 id="manually-triggering-tasks-in-handlers">Manually Triggering Tasks in Handlers</h3>
<blockquote>
<p>Manually triggering tasks is not recommended, as it couples your application to Swoole, preventing usage in non-async paradigms as well as alternate async contexts.
It can also make testing your application more difficult.</p>
<p>We recommend the approach described in the section <a href="#dispatching-a-servicebasedtask-via-a-psr-14-event-dispatcher">"Dispatching a ServiceBasedTask via a PSR-14 Event Dispatcher"</a>.</p>
</blockquote>
<p>If you want to manually dispatch a task, you will need to:</p>
<ul>
<li>Compose the <code>Swoole\Http\Server</code> instance in your class.</li>
<li>Call that instance's <code>task()</code> method with the data representing the task.</li>
</ul>
<p>As an example, we will create a request handler that composes the HTTP server instance.</p>
<pre class="highlight"><code class="language-php">namespace Example;

use Psr\Http\Message\ResponseFactoryInterface;
use Psr\Http\Message\ResponseInterface;
use Psr\Http\Message\ServerRequestInterface;
use Psr\Http\Server\RequestHandlerInterface;
use Swoole\Http\Server as HttpServer;

class TaskTriggeringHandler implements RequestHandlerInterface
{
    /** @var ResponseFactoryInterface */
    private $responseFactory;

    /** @var HttpServer */
    private $server;

    public function __construct(
        HttpServer $server,
        ResponseFactoryInterface $responseFactory
    ) {
        $this-&gt;server          = $server;
        $this-&gt;responseFactory = $responseFactory;
    }

    public function handle(ServerRequestInterface $request) : ResponseInterface
    {
        // Gather data from request
        $data = $request-&gt;getParsedBody();

        // task() returns a task identifier, if you want to use it; otherwise,
        // you can ignore the return value.
        $taskIdentifier = $this-&gt;server-&gt;task([
            'to'      =&gt; $data['email'],
            'subject' =&gt; $data['subject'],
            'message' =&gt; $data['message'],
        ]);

        // The task() method is asynchronous, so execution continues immediately.
        return $this-&gt;responseFactory()-&gt;createResponse();
    }
}</code></pre>
<p>Your handler will require a factory:</p>
<pre class="highlight"><code class="language-php">namespace Example;

use Psr\Container\ContainerInterface;
use Psr\Http\Message\ResponseFactoryInterface;
use Swoole\Http\Server as HttpServer;

class TaskTriggeringHandlerFactory
{
    public function __invoke(ContainerInterface $container): TaskTriggeringHandler
    {
        return new TaskTriggeringHandler(
            $container-&gt;get(HttpServer::class),
            $container-&gt;get(ResponseFactoryInterface::class)
        );
    }
}</code></pre>
<p>And you will then need to notify the container configuration:</p>
<pre class="highlight"><code class="language-php">// in config/autoload/global.php or similar:

use Example\TaskTriggeringHandler;
use Example\TaskTriggeringHandlerFactory;

return [
    'dependencies' =&gt; [
        'factories' =&gt; [
            TaskTriggeringHandler::class =&gt; TaskTriggeringHandlerFactory::class,
        ],
    ],
];</code></pre>
<h3 id="logging-taskevent-listener">Logging TaskEvent listener</h3>
<p>The following listener will listen to a <code>TaskEvent</code>, and log the information using the syslog.</p>
<pre class="highlight"><code class="language-php">namespace Example;

use Mezzio\Swoole\Event\TaskEvent;

use function date;
use function sprintf;
use function syslog;
use function var_dump;

use const LOG_INFO;

class LoggingListener
{
    public function __invoke(TaskEvent $event): void
    {
        syslog(LOG_INFO, sprintf(
            '[%s] [%d] %s',
            date('c'),
            $event-&gt;getTaskId(),
            var_dump($event-&gt;getData())
        ));
    }
}</code></pre>
<p>You would configure the application to use the listener as follows:</p>
<pre class="highlight"><code class="language-php">// in config/autoload/swoole.global.php or similar:

use Example\LoggingListener;
use Mezzio\Swoole\Event\TaskEvent;

return [
    'dependencies' =&gt; [
        'invokables' =&gt; [
            LoggingListener::class =&gt; LoggingListener::class,
        ],
    ],
    'mezzio-swoole' =&gt; [
        'swoole-http-server' =&gt; [
            'listeners' =&gt; [
                TaskEvent::class =&gt; [
                    LoggingListener::class,
                ],
            ],
        ],
    ],
];</code></pre>
<p>To trigger the event, you will create a task using a <code>Swoole\Http\Server</code> instance:</p>
<pre class="highlight"><code class="language-php">$server-&gt;task($data);</code></pre>
<blockquote>
<p>See the <a href="#manually-triggering-tasks-in-handlers">"Manually Triggering Tasks in Handlers"</a> example for details on injecting the Swoole HTTP server in a request handler.</p>
</blockquote>
<h3 id="logging-taskfinishevent-listener">Logging TaskFinishEvent listener</h3>
<p>The following listener will listen to a <code>TaskFinishEvent</code>, and log the return value using the syslog.
It looks almost identical to the previous example.</p>
<pre class="highlight"><code class="language-php">namespace Example;

use Mezzio\Swoole\Event\TaskFinishEvent;

use function date;
use function sprintf;
use function syslog;
use function var_dump;

use const LOG_INFO;

class TaskCompletionLoggingListener
{
    public function __invoke(TaskFinishEvent $event): void
    {
        syslog(LOG_INFO, sprintf(
            '[%s] [%d] %s',
            date('c'),
            $event-&gt;getTaskId(),
            var_dump($event-&gt;getReturnValue())
        ));
    }
}</code></pre>
<p>Similar to the previous example, you would configure the application to use the listener as follows:</p>
<pre class="highlight"><code class="language-php">// in config/autoload/swoole.global.php or similar:

use Example\TaskCompletionLoggingListener;
use Mezzio\Swoole\Event\TaskFinishEvent;

return [
    'dependencies' =&gt; [
        'invokables' =&gt; [
            TaskCompletionLoggingListener::class =&gt; TaskCompletionLoggingListener::class,
        ],
    ],
    'mezzio-swoole' =&gt; [
        'swoole-http-server' =&gt; [
            'listeners' =&gt; [
                TaskFinishEvent::class =&gt; [
                    TaskCompletionLoggingListener::class,
                ],
            ],
        ],
    ],
];</code></pre>
<p>Unlike the previous example, however, you do not need to trigger this event yourself; it gets triggered by the <code>SwooleRequestHandlerRunner</code>.</p>
<h3 id="queueing-task-data-for-the-taskeventdispatchlistener">Queueing task data for the TaskEventDispatchListener</h3>
<p>In this example, we will configure the <code>TaskEventDispatchListener</code> as a <code>TaskEvent</code> listener.
The <code>TaskEventDispatchListener</code> will in turn have a listener attached for a custom event, <code>SomeDeferrableTask</code>.
We will queue a <code>SomeDeferrableTask</code> instance via the Swoole HTTP server <code>task()</code> method to defer its execution to the custom listener we create.</p>
<p>First, we will create the custom task type:</p>
<pre class="highlight"><code class="language-php">namespace Example;

class SomeDeferrableTask
{
}</code></pre>
<p>Next, we will create a listener for this event type:</p>
<pre class="highlight"><code class="language-php">namespace Example;

class SomeDeferrableTaskListener
{
    public function __invoke(SomeDeferrableTask $event): void
    {
        // process the task here
    }
}</code></pre>
<p>Next, we will configure listeners for the <code>TaskEvent</code> and our custom <code>SomeDeferrableTask</code>:</p>
<pre class="highlight"><code class="language-php">// in config/autoload/swoole.global.php or similar:

use Example\SomeDeferrableTask;
use Example\SomeDeferrableTaskListener;
use Mezzio\Swoole\Event\TaskEvent;
use Mezzio\Swoole\Event\TaskEventDispatchListener;

return [
    'dependencies' =&gt; [
        'invokables' =&gt; [
            SomeDeferrableTaskListener::class =&gt; SomeDeferrableTaskListener::class,
        ],
    ],
    'mezzio-swoole' =&gt; [
        'swoole-http-server' =&gt; [
            'listeners' =&gt; [
                SomeDeferrableTask::class =&gt; [
                    SomeDeferrableTaskListener::class,
                ],
                TaskEvent::class =&gt; [
                    TaskEventDispatchListener::class,
                ],
            ],
        ],
    ],
];</code></pre>
<p>To trigger the event, you will create a task using a <code>Swoole\Http\Server</code> instance:</p>
<pre class="highlight"><code class="language-php">$server-&gt;task(new SomeDeferrableTask());</code></pre>
<blockquote>
<p>See the <a href="#manually-triggering-tasks-in-handlers">"Manually Triggering Tasks in Handlers"</a> example for details on injecting the Swoole HTTP server in a request handler.</p>
</blockquote>
<h3 id="queueing-a-task-for-the-taskinvokerlistener">Queueing a Task for the TaskInvokerListener</h3>
<p>In this example, we register the <code>TaskInvokerListener</code> with the <code>TaskEvent</code>.
We then create a <code>Mezzio\Swoole\Task\Task</code> instance and use the Swoole HTTP server to queue the task.</p>
<p>First, we will configure the <code>TaskInvokerListener</code> for the <code>TaskEvent</code>:</p>
<pre class="highlight"><code class="language-php">// in config/autoload/swoole.global.php or similar:

use Mezzio\Swoole\Event\TaskEvent;
use Mezzio\Swoole\Task\TaskInvokerListener;

return [
    'mezzio-swoole' =&gt; [
        'swoole-http-server' =&gt; [
            'listeners' =&gt; [
                TaskEvent::class =&gt; [
                    TaskInvokerListener::class,
                ],
            ],
        ],
    ],
];</code></pre>
<p>Next, we will create a <code>Task</code> instance.
The constructor for <code>Mezzio\Swoole\Task\Task</code> expects a callable listener as the first argument, and then zero or more additional arguments representing the arguments to pass to the listener.</p>
<pre class="highlight"><code class="language-php">use Mezzio\Swoole\Task\Task;

$task = new Task(
    static function(object $event): void {
        // Process the $event object
    },
    (object) [
        'message' =&gt; 'hello world',
    ]
);</code></pre>
<p>Finally, we will enqueue the task using a <code>Swoole\Http\Server</code> instance:</p>
<pre class="highlight"><code class="language-php">$server-&gt;task($task);</code></pre>
<blockquote>
<p>See the <a href="#manually-triggering-tasks-in-handlers">"Manually Triggering Tasks in Handlers"</a> example for details on injecting the Swoole HTTP server in a request handler.</p>
</blockquote>
<h3 id="queueing-a-servicebasedtask-for-the-taskinvokerlistener">Queueing a ServiceBasedTask for the TaskInvokerListener</h3>
<p>In this example, we'll create a listener class that can handle a specific event type.
We will create a factory for the listener, and register it in the DI container.
We will also register the <code>TaskInvokerListener</code> with the <code>TaskEvent</code>.
Finally, we will then create a <code>Mezzio\Swoole\Task\ServiceBasedTask</code> instance using the service name for our listener and an instance of the event type it expects,  and use the Swoole HTTP server to queue the task.</p>
<p>First, let's define an event type:</p>
<pre class="highlight"><code class="language-php">namespace Example;

class SomeDeferrableEvent
{
    /** @var string */
    private $message;

    public function __construct(string $message)
    {
        $this-&gt;message = $message;
    }

    public function __toString(): string
    {
        return $this-&gt;message;
    }
}</code></pre>
<p>Next, we will create a listener for this event type:</p>
<pre class="highlight"><code class="language-php">namespace Example;

use Psr\Log\LoggerInterface;

class SomeDeferrableEventListener
{
    /** @var LoggerInterface */
    private $logger;

    public function __construct(LoggerInterface $logger)
    {
        $this-&gt;logger = $logger;
    }

    public function __invoke(SomeDeferrableEvent $event): void
    {
        $this-&gt;logger-&gt;info(sprintf('Message: %s', (string) $event));
    }
}</code></pre>
<p>The listener will require a factory:</p>
<pre class="highlight"><code class="language-php">namespace Example;

use Psr\Container\ContainerInterface;
use Psr\Log\LoggerInterface;

class SomeDeferrableEventListenerFactory
{
    public function __invoke(ContainerInterface $container): SomeDeferrableEventListener
    {
        return new SomeDeferrableEventListener(
            $container-&gt;get(LoggerInterface::class)
        );
    }
}</code></pre>
<p>At this point, we turn to configuration.
We will add dependency configuration for our listener (omitting the configuration for the logger service; we will assume you have done so already, or can figure out how to do so).
We will also add configuration to bind the <code>TaskInvokerListener</code> to the <code>TaskEvent</code>.</p>
<pre class="highlight"><code class="language-php">// in config/autoload/swoole.global.php or similar:

use Example\SomeDeferrableEventListener;
use Example\SomeDeferrableEventListenerFactory;
use Mezzio\Swoole\Event\TaskEvent;
use Mezzio\Swoole\Task\TaskInvokerListener;

return [
    'dependencies' =&gt; [
        'factories' =&gt; [
            SomeDeferrableEventListener::class =&gt; SomeDeferrableEventListenerFactory::class,
        ],
    ],
    'mezzio-swoole' =&gt; [
        'swoole-http-server' =&gt; [
            'listeners' =&gt; [
                TaskEvent::class =&gt; [
                    TaskInvokerListener::class,
                ],
            ],
        ],
    ],
];</code></pre>
<p>Next, we will create a <code>ServiceBasedTask</code> instance.
The constructor for <code>Mezzio\Swoole\Task\Task</code> expects the name of a service that can be pulled from the application DI container as the first argument, and then zero or more additional arguments representing the arguments to pass to the listener.
The service is expected to be invokable (i.e., it MUST define the method <code>__invoke()</code>).</p>
<pre class="highlight"><code class="language-php">use Example\SomeDeferrableEvent;
use Example\SomeDeferrableEventListener;
use Mezzio\Swoole\Task\ServiceBasedTask;

$task = new ServiceBasedTask(
    SomeDeferrableEventListener::class,
    new SomeDeferrableEvent('hello world')
);</code></pre>
<p>Finally, we will enqueue the task using a <code>Swoole\Http\Server</code> instance:</p>
<pre class="highlight"><code class="language-php">$server-&gt;task($task);</code></pre>
<blockquote>
<p>See the <a href="#manually-triggering-tasks-in-handlers">"Manually Triggering Tasks in Handlers"</a> example for details on injecting the Swoole HTTP server in a request handler.</p>
</blockquote>
<h3 id="dispatching-a-servicebasedtask-via-a-psr-14-event-dispatcher">Dispatching a ServiceBasedTask via a PSR-14 Event Dispatcher</h3>
<p>This final example builds on the previous.
We will use the same event and listener.
However, instead of queueing the task via the Swoole HTTP server, we will queue it via a PSR-14 event dispatcher.
To make that possible, we will add a delegator factory for our listener that will do the work of queueing the task for us.</p>
<p>This example will make the assumption that you are using the same PSR-14 event dispatcher with both the <code>SwooleRequestHandlerRunner</code> and the rest of your application, and will re-purpose the <code>Mezzio\Swoole\Event\SwooleListenerProvider</code> to also handle listeners for our <code>Example\SomeDeferrableEvent</code>.</p>
<p>First, we will define a handler that triggers this event:</p>
<pre class="highlight"><code class="language-php">namespace Example;

use Psr\EventDispatcher\EventDispatcherInterface;
use Psr\Http\Message\ServerRequestInterface;
use Psr\Http\Message\ResponseFactoryInterface;
use Psr\Http\Message\ResponseInterface;
use Psr\Http\Server\RequestHandlerInterface;

class MessageHandler implements RequestHandlerInterface
{
    /** @var EventDispatcherInterface */
    private $dispatcher;

    /** @var ResponseFactoryInterface */
    private $responseFactory;

    public function __construct(
        EventDispatcherInterface $dispatcher,
        ResponseFactoryInterface $responseFactory
    ) {
        $this-&gt;dispatcher      = $dispatcher;
        $this-&gt;responseFactory = $responseFactory;
    }

    public function handle(ServerRequestInterface $request): ResponseInterface
    {
        $this-&gt;dispatcher-&gt;dispatch(new SomeDeferrableEvent('hello world'));
        return $this-&gt;responseFactory-&gt;createResponse();
    }
}</code></pre>
<p>This handler will need a factory.</p>
<pre class="highlight"><code class="language-php">namespace Example;

use Psr\Container\ContaienrInterface;
use Psr\EventDispatcher\EventDispatcherInterface;
use Psr\Http\Message\ResponseFactoryInterface;

class MessageHandlerFactory
{
    public function __invoke(ContainerInterface $container): MessageHandler
    {
        return new MessageHandler(
            $container-&gt;get(EventDispatcherInterface::class),
            $container-&gt;get(ResponseFactoryInterface::class)
        );
    }
}</code></pre>
<p>The next step is changing configuration.
We need to configure our container to tell it about our handler, as well as to add the <code>Mezzio\Swoole\Task\DeferredServiceListenerDelegator</code> as a delegator factory for our <code>Example\SomeDeferrableEventListener</code>.
We will also add configuration to map our listener to our custom event.</p>
<pre class="highlight"><code class="language-php">// in config/autoload/swoole.global.php or similar:

use Example\MessageHandler;
use Example\MessageHandlerFactory;
use Example\SomeDeferrableEvent;
use Example\SomeDeferrableEventListener;
use Example\SomeDeferrableEventListenerFactory;
use Mezzio\Swoole\Event\TaskEvent;
use Mezzio\Swoole\Task\TaskInvokerListener;
use Mezzio\Swoole\Task\DeferredServiceListenerDelegator;

return [
    'dependencies' =&gt; [
        'factories' =&gt; [
            MessageHandler::class              =&gt; MessageHandlerFactory::class,
            SomeDeferrableEventListener::class =&gt; SomeDeferrableEventListenerFactory::class,
        ],
        'delegators' =&gt; [
            SomeDeferrableEventListener::class =&gt; [
                DeferredServiceListenerDelegator::class,
            ],
        ],
    ],
    'mezzio-swoole' =&gt; [
        'swoole-http-server' =&gt; [
            'listeners' =&gt; [
                SomeDeferrableEvent::class =&gt; [
                    SomeDeferrableEventListener::class,
                ],
                TaskEvent::class =&gt; [
                    TaskInvokerListener::class,
                ],
            ],
        ],
    ],
];</code></pre>
<p>At this point, we are done.</p>
<p>When the handler dispatches the event, our listener is notified.
However, the listener is decoreated via the <code>DeferredServiceListenerDelegator</code>, which will itself enqueue a <code>ServiceBasedTask</code> in the Swoole HTTP server, using the listener's service name and the event passed to the listener.
The <code>TaskInvokerListener</code> then passes the container to the task, which pulls our listener and executes it with the event.</p>




    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../logging/">
                    <small class="page-nav__label">Previous</small>
                    <i class="fa fa-chevron-left"></i>
                    Logging
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../table/">
                    <small class="page-nav__label">Next</small>
                    Using Swoole Tables
                    <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



                
            </div>
            <div class="col-md-3 col-sm-12 sidebar">
                <div class="donation-banner">
    <a href="https://getlaminas.org/support/">
        <h2>Donate</h2>
        <p>Support Laminas Developers Directly</p>
        <img src="https://funding.communitybridge.org/assets/cb-f-horizontal-white.svg">
    </a>
</div>

                
                    <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">mezzio-swoole</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                
                    
                        
    <li class="subnavigation__list-item ">
        <a href="../intro/" class="subnavigation__link">Introduction</a>
    </li>

                    
                        
    <li class="subnavigation__list-item">
        <span class="subnavigation__headline">Reference</span>
        <ul class="subnavigation__list">
            
                
    <li class="subnavigation__list-item ">
        <a href="../events/" class="subnavigation__link">Swoole HTTP Server Events</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../static-resources/" class="subnavigation__link">Static Resources</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../logging/" class="subnavigation__link">Logging</a>
    </li>

            
                
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Async Tasks</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../table/" class="subnavigation__link">Using Swoole Tables</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../hot-code-reload/" class="subnavigation__link">Hot Code Reloading</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../command-line/" class="subnavigation__link">Command Line Tooling</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../how-it-works/" class="subnavigation__link">How it works</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../considerations/" class="subnavigation__link">Considerations when using Swoole</a>
    </li>

            
        </ul>
    </li>

                    
                        
    <li class="subnavigation__list-item">
        <span class="subnavigation__headline">Cookbook</span>
        <ul class="subnavigation__list">
            
                
    <li class="subnavigation__list-item ">
        <a href="../cookbook/static-resource-listener-removal/" class="subnavigation__link">Removing the StaticResourceRequestListener</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../cookbook/swoole-not-starting/" class="subnavigation__link">Swoole-based server always returns home page</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../cookbook/provide-a-request-id/" class="subnavigation__link">Provide a unique ID in your request</a>
    </li>

            
        </ul>
    </li>

                    
                        
    <li class="subnavigation__list-item ">
        <a href="../migration/" class="subnavigation__link">Migration</a>
    </li>

                    
                
            

                
                

                    
                    
                
            

                
                

                    
                    
                
            

                
                

                    
                    
                
            
        </ul>
    </div>

                    
                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <h5>Laminas</h5>
                <ul>
                    <li>Laminas Project <a href="https://getlaminas.org/">The new foundation for the community-supported, open source continuation of Zend Framework</a></li>
                    <li>Laminas Components and MVC <a href="https://docs.laminas.dev/">Components and MVC for enterprise applications</a></li>
                    <li>Mezzio <a href="https://docs.mezzio.dev/">PSR-15 middleware in minutes</a></li>
                    <li>Laminas API Tools <a href="https://api-tools.getlaminas.org/">Build RESTful APIs in minutes</a></li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="row">

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">Support</h4>
                        <ul class="support__list">
                            <li class="support__list-item">
                                <a href="https://discourse.laminas.dev" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://laminas.dev/chat" class="support__link" title="Chat"><i class="fab fa-slack"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://github.com/laminas" class="support__link" title="Github"><i class="fab fa-github"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://phpc.social/@getlaminas" class="support__link" title="Mastodon"><i class="fab fa-mastodon"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://getlaminas.org/blog/rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://getlaminas.org/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                            </li>
                        </ul>
                    </div>

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">License</h4>
                        <p>
                            Code licensed under <a
                                href="https://github.com/mezzio/mezzio-swoole/blob/-/LICENSE.md">BSD 3-Clause</a>.
                        </p>
                    </div>

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">Copyright</h4>
                        <p>
                            <!--Built with love by the Laminas team with the help of our
                            <a href="https://github.com/mezzio/mezzio-swoole/graphs/contributors">contributors</a>.<br>-->
                            &copy; 2024 <a href="https://getlaminas.org/">Laminas Project</a> a Series of LF Projects, LLC.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

    <script>
        let base_url = '../..',
            project  = "mezzio",
            siteName = 'mezzio-swoole';
    </script>
    <script src="https://docs.laminas.dev/js/scripts.js"></script>
    
        <script src="../../search/main.js"></script>
    

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search in mezzio-swoole" id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
        </div>
    </div>
</div>
</body>


</html>
